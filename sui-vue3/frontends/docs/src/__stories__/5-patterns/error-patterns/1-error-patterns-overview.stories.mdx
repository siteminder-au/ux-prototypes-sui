import {Canvas, Meta, Story } from '@storybook/addon-docs'
import { SuiStorybookPageLabel, SuiStorybookTitle } from '@/components'
import typesInput from './images/types-input.png'
import typesSecurityRestriction from './images/types-security-restriction.png'
import typesApplication from './images/types-app-errors.png'
import hierarchyComponent from './images/hierarchy-component.png'
import hierarchyContainer from './images/hierarchy-container.png'
import hierarchyPage from './images/hierarchy-page.png'
import hierarchyGlobal from './images/hierarchy-global.png'

<Meta title="Design patterns/Error patterns/Overview" />

<SuiStorybookPageLabel>Design patterns</SuiStorybookPageLabel>

<SuiStorybookTitle>
  <h1>Error patterns</h1>
  <p>Errors offer users valuable feedback within a specific context, enabling them to address failures and prevent potential issues down the line.</p>
</SuiStorybookTitle>

- [Product context](#product-context)
- [Importance of error patterns](#importance-of-error-patterns)
- [Types of errors](#types-of-errors)
- [Error hierarchy](#error-hierarchy)
- [Guidelines and recommendations](#guidelines-and-recommendations)
- [Accessibility](#accessibility)


## Product context
Our platform employs various approaches to displaying errors, and the main objective of this pattern is to clearly document and explain each method's usage. This ensures that we create a platform that is unified and consistent in its implementation.

## Importance of error patterns
- Error patterns ensure a uniform approach to error handling throughout a system or platform.
- Well-designed error patterns improve the user experience by offering clear and useful feedback during error occurrences.
- Error patterns provide actionable information that helps users identify and resolve underlying issues.
- Error patterns empower users by supplying them with the necessary guidance to overcome failures, promoting confidence in platform usage.
- Consistently applied error patterns facilitate user learning and comprehension of error communication and resolution.
- Recognizing common user errors allows for refining the user interface, enhancing usability, and minimizing future error instances.

<div className="sui-storybook-highlight"> <p>"â€œError flows should be designed to help users fix the mistakes in a form and advise them how to avoid making more. Ensure that users can easily detect errors, understand how to fix them, and see the error message while correcting the corresponding error. Remove the guesswork and let users get on with their tasks." </p><p> <a href="https://www.nngroup.com/articles/errors-forms-design-guidelines/"> NNGroup</a></p></div>


## Types of errors

  ### User input errors
  User input errors occur when users make mistakes or provide incorrect information, selections, or actions while using a system, application, or interface. These errors happen when users' inputs don't match the expected format, requirements, or constraints of the system.
  <img src={typesInput} alt="Input in error state as an example of user input error." width="340" />

  ### Security restriction errors
  User input errors occur when users make mistakes or provide incorrect information, selections, or actions while using a system, application, or interface. These errors happen when users' inputs don't match the expected format, requirements, or constraints of the system.
  <img src={typesSecurityRestriction} alt="In-app error used as full page errors in our app, that also require our navigation to be present/is in our app."  />

  ### Application errors
  Application errors occur independent of user input. They are issues that occur within the application for different reasons, such as bugs, unforeseen user inputs, system failures, or compatibility problems. These errors can vary in severity, from small issues with minimal user impact to critical errors that can disrupt the user experience or cause data loss.
  <img src={typesApplication} alt="In-app error used as full page errors in our app, that also require our navigation to be present/is in our app."  />

## Error hierarchy

  ### Component
  Errors tied to a specific component or element on a page. These are usually used as a form inline validation.
  <img src={hierarchyComponent} alt="Error hierarchy on component level showing inline validation on input." width="340"  />

  ### Container
  Containers like dialogs are important for drawing attention to errors or alerts. They create dedicated spaces or pop-ups that effectively highlight and communicate errors to users.
  <img src={hierarchyContainer} alt="Error hierarchy on container level showing inline validation and help card on top on form." width="420"  />

  ### Page
  Page level errors are not tied to specific components. This could happen when multiple errors are in a page or access is denied to a specific user.
  <img src={hierarchyPage} alt="Error hierarchy on page level showing a toast on booking performance page with message saying error retrieving data and an in-app error page showing unauthorised access in rooms and rates page."  />

  ### Global
  Global errors indicate issues that affect the entire application or website, rather than being tied to a component or element or user action. Samples are when a server fails to retrieve page information due to lost of connection, non-existing pages, server errors or maintenance.
  <img src={hierarchyGlobal} alt="a 404 error page saying page not found."  />

## Guidelines and recommendations
According to NNGroup, there are a couple of guidelines to follow for creating effective errors in which they are grouped them into 3 categories:

- Visibility: refers to how users perceive the error message.
- Communication: involves what information the error message provides about the problem and potential solutions
- Efficiency:  how effectively the error helps users understand and resolve the issues they encounter.

### 1. Visibility Guidelines
Make errors instantly noticeable and recognizable to users.

- <strong> Show the error message near the location where the error occurred.</strong><br /> Proximity assists users in linking the content of the error message with the specific interface elements that require their attention.
- <strong> Use clear, repetitive, and easily noticeable indicators.</strong><br /> Red color and exclamation marks remain popular methods to draw users' attention to errors. However, it is important to be cautious when relying solely on color to indicate errors, as it may not be effective for color-blind users. Additionally, consider the readability of the indicators on various devices.
- <strong> Create error designs according to their consequences or effects.</strong><br /> Errors can vary in severity and impact on users and the system. For critical errors, the message should be urgent and noticeable, while for less severe ones, it can be more informative and less obtrusive. Customizing error designs based on their potential impact allows designers to communicate effectively with users and improve their navigation through the system.
- <strong> Refrain from showing errors too early or before they are necessary.</strong><br /> Error messages should not be displayed to users until they are relevant and essential. Showing errors prematurely can confuse or frustrate users, especially if they haven't had a chance to input their information properly or complete a task.

### 2. Communication Guidelines
It is necessary to include text that provides explanations and helps the user recover from the error.

- <strong> Use language that is easy to understand.</strong><br /> Avoid technical terms and opt for language that your users are familiar with instead.
- <strong> Describe the issue briefly and accurately.</strong><br /> Avoid using vague messages that lack context (i.e. "An error occurred"). Instead, provide specific descriptions of the exact problems to help users understand what happened.
- <strong> Offer clear guidance on how to resolve the issue or proceed.</strong><br /> It's not enough to inform the user about the error; it's essential to guide them on what to do next. Quickly provide instructions on how to resolve the issue.

In writing error messages, ensure that the error effectively communicates three essential pieces of information:
1. The nature of the problem <strong>(What happened)</strong>
2. The reason behind the problem <strong>(Why it happened)</strong>
3. Clear guidance on how to resolve the issue or proceed <strong>(How to resolve or move forward)</strong>

### 3. Efficiency Guidelines
Provide instructions to help users resolve the situation quickly, and to  enhance their understanding and prevent similar issues in the future.

- <strong>Take precautions to prevent probable errors.</strong><br />If users make a mistake and get no feedback, it can cause confusion, wasted effort, and frustration to build up.
- <strong>Keep the user's input saved or intact.</strong><br />Allow users to correct errors by editing their initial input instead of having to begin from the start.
- <strong>Minimize the effort required to correct an error.</strong><br />When feasible, provide a few likely solutions for users to choose from instead of having them figure out the correct action on their own.
- <strong>Briefly explain how the system operates.</strong><br />Provide clear explanations to users about how the system functions and how to resolve errors. In cases when more information is needed, use hyperlinks to connect concise error messages to pages with supplementary material or explanations of the problem.


## Accessibility
<a href="https://www.w3.org/WAI/WCAG21/Understanding/error-identification.html"> SC 3.3.1: Error Identification (Level A)</a><br/>
If an input error is automatically detected, the item that is in error is identified and the error is described to the user in text.
Ensure that users are aware that an error has occurred and can determine what is wrong. <br /><br />

<a href="https://www.w3.org/WAI/WCAG21/Understanding/error-suggestion.html#:~:text=Understanding%20SC%203.3.,%3AError%20Suggestion%20(Level%20AA)&text=If%20an%20input%20error%20is,or%20purpose%20of%20the%20content."> SC 3.3.3: Error Suggestion (Level AA)</a><br/>
If an input error is automatically detected, the item that is in error is identified and the error is described to the user in text.
Ensure that users are aware that an error has occurred and can determine what is wrong.<br /><br />

<a href="https://www.w3.org/WAI/WCAG21/Understanding/error-prevention-legal-financial-data.html#:~:text=Understanding%20SC%203.3.-,4%3AError%20Prevention%20(Legal%2C%20Financial,%2C%20Data)%20(Level%20AA)&text=For%20Web%20pages%20that%20cause,Reversible"> SC 3.3.4: Error Prevention (Legal, Financial, Data) (Level AA)</a><br/>
For web pages that cause legal commitments or financial transactions for the user to occur, that modify or delete user-controllable data in data storage systems, or that submit user test responses, at least one of the following is true:

Reversible: Submissions are reversible.<br />
Checked: Data entered by the user is checked for input errors and the user is provided an opportunity to correct them..<br />
Confirmed: A mechanism is available for reviewing, confirming, and correcting information before finalizing the submission.
<br />
Ensure that users are aware that an error has occurred and can determine what is wrong.
